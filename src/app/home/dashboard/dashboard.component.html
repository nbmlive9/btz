<div class="wallet-container d-flex flex-column min-vh-100 bg-light">

  <!-- HEADER -->
  <header class="wallet-header shadow-sm d-flex align-items-center justify-content-between px-3 py-2 bg-white rounded-bottom">
    <div class="d-flex flex-column">

    </div>
    <img src="assets/favicon.png" alt="Logo" class="header-logo">
    <div class="d-flex align-items-center gap-3">
      <i class="bi bi-share fs-3 cursor-pointer text-primary" (click)="openSharePopup()"></i>
    </div>

<!-- SHARE POPUP MODAL -->
<div class="modal fade" id="shareModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-4 shadow-lg border-0">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold text-dark">Share Referral Link</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
  <p class="text-muted small mb-4 text-center">
    Share your referral link with friends and earn rewards!
  </p>

  <!-- Share buttons -->
  <div class="d-flex justify-content-around mb-4 flex-wrap">
    <!-- WhatsApp -->
    <div class="share-icon text-center mb-2" (click)="shareTo('whatsapp')">
      <i class="bi bi-whatsapp fs-4"></i>
      <div class="small">WhatsApp</div>
    </div>

    <!-- Telegram -->
    <div class="share-icon text-center mb-2" (click)="shareTo('telegram')">
      <i class="bi bi-telegram fs-4"></i>
      <div class="small">Telegram</div>
    </div>

    <!-- IMO -->
    <div class="share-icon text-center mb-2" (click)="shareTo('imo')">
      <img src="assets/imo.png" alt="IMO" style="width:50px; height:50px;" />
      <div class="small">IMO</div>
    </div>
  </div>

  <!-- Copy referral link card -->
  <div class="card p-3 mb-3 shadow-sm rounded-3 text-center">
    <p class="mb-2 text-truncate" style="max-width: 100%;">
      https://bitraze.org/btz/referral/{{ pfdata?.regid }}
    </p>
    <button class="btn btn-outline-primary btn-sm w-100 d-flex align-items-center justify-content-center"
            (click)="copyReferralLink()">
      <i class="fa fa-clone me-2"></i> Copy Link
    </button>
    <p *ngIf="copiedLink" class="text-success small mt-2 mb-0">Copied!</p>
  </div>
</div>


      <div class="modal-footer border-0">
        <button class="btn btn-secondary w-100 rounded-pill" data-bs-dismiss="modal">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
  </header>

  <div class="staking-banner dashboard-welcome mx-3 p-3 rounded-4 shadow-lg d-flex bg-white mt-2 ">
  <div class="welcome-text">
    <h6 class="fw-bold mb-1">Welcome, {{ pfdata?.name }}!</h6>
    <p class="mb-0 text-white">Your RegID: <span class="fw-semibold">{{ pfdata?.regid }}</span></p>
  </div>
</div>

  
    <!-- CONGRATULATION STAKING BANNER -->
<div class="staking-banner mx-3 my-3 p-3 rounded-4 shadow-lg d-flex justify-content-between align-items-center">
  <div class="banner-text">
    <p class="mb-0">{{ pfdata?.coins}} <span class="small">BTZ</span></p>
  </div>
  <div class="banner-amount text-end">
    <h6 class="fw-bold text-white">Staking token</h6>
  </div>
</div>

<div class="staking-banner dashboard-welcome1 mx-3 my-1 p-3 rounded-4 shadow-lg d-flex justify-content-between align-items-center">
  <div class="banner-text">
    <p class="mb-0">Balance Business</p>
  </div>
  <div class="banner-amount text-end">
    <h6 class="fw-bold text-white">{{ pfdata?.balance | currency:'USD':'symbol':'1.0-2'}} </h6>
  </div>
</div>

  <!-- WALLET BALANCE CARD -->
  <div class="card  balance-card mx-3 mt-1 shadow-lg">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6 class="text-white fw-bold"><i class="bi bi-wallet2 me-1"></i> Wallet Asset</h6>
        <small class="btn btn-sm btn-light text-success fw-semibold"  data-bs-toggle="modal"
                data-bs-target="#withdrawfunds"
                (click)="openWithdrawModal()">Go to Withdraw <i class="bi bi-arrow-right"></i></small>
      </div>
      <h4 class="fw-bold text-white d-flex align-items-center">{{ pfdata?.walletamount | currency:'USD':'symbol':'1.0-2' }} </h4>
      <p class="text-white mb-1">{{ pfdata?.actwallet | currency:'USD':'symbol':'1.0-2' }} P2P</p>
      <!-- <small class="text-white fw-bold">{{ pfdata?.wallet1 }}
        <i class="fa fa-clone ms-2" style="cursor:pointer;" (click)="copyAddres()"></i>
      </small> -->
      <p *ngIf="copied" class="text-white mt-1">Copied!</p>
      <div class="d-flex justify-content-between mt-3 text-white">
        <div><small>Growth Bonus</small><br>{{ pfdata?.repurchasewallet | currency:'USD':true:'1.0-2' }} btz</div>
        <div><small>My Referrals</small><br><i class="fa fa-user"></i> {{ hdata?.sponsors }}</div>
      </div>
    </div>
  </div>

  <!-- PROMO BANNER -->
  <div class="promo-banner mx-3 mt-3 d-flex justify-content-between align-items-center shadow-sm">
    <div class="promo-text">
      <h6>Welcome bonus for each $1 get 100btz Tokens</h6>
      <a routerLink="/dashboard">Explore Now â†’</a>
    </div>
    <div class="promo-img">
    </div>
  </div>
    <div class="container">
      <div>
        <button class="btn btn-outline-primary btn-sm mt-2 w-100 fw-bold"
                data-bs-toggle="modal"
                data-bs-target="#gIncomeModal"
                (click)="openGBonusModal()">
          View G-Team Incomes
        </button>
      </div>
    </div>
  <!-- QUICK ACTIONS SCROLLER -->
  <div class="container mt-3">
    <div class="d-flex flex-nowrap overflow-auto hide-scrollbar">
      <div class="scroll-item text-center" routerLink="/transfer">
        <i class="bi bi-box-arrow-up-right fs-4"></i>
        <p class="mt-1 small">Send</p>
      </div>
      <div class="scroll-item text-center" routerLink="/receive">
        <i class="bi bi-arrow-down-square fs-4"></i>
        <p class="mt-1 small">Receive</p>
      </div>
         <div class="scroll-item text-center" routerLink="/selftransfer">
        <i class="bi bi-arrow-repeat fs-4"></i>
        <p class="mt-1 small">Transfer</p>
      </div>
      <div class="scroll-item text-center" routerLink="/walletri">
        <i class="bi bi-check-square fs-4"></i>
        <p class="mt-1 small">Stake</p>
      </div>
      <div class="scroll-item text-center" routerLink="/report">
        <i class="bi bi-file-earmark-text fs-4"></i>
        <p class="mt-1 small">Reports</p>
      </div>
         <div class="scroll-item text-center" routerLink="/withdrawreport">
        <i class="bi bi-credit-card fs-4"></i>
        <p class="mt-1 small">Withdraw</p>
      </div>
    </div>
  </div>

<div class="container mt-3">
  <h5 class="fw-bold mb-2">Stacking BTZ</h5>
  <div class="d-flex overflow-auto hide-scrollbar">
    
    <!-- Card 1: Bitraze Lite -->
    <div class="investment-card card-lite flex-shrink-0" routerLink="/bitraze-lite">
      <div class="card-image">
        <img src="assets/c1.png" alt="Bitraze Lite">
      </div>
    </div>

    <!-- Card 2: Bitraze Pro -->
    <div class="investment-card card-pro flex-shrink-0" routerLink="/bitraze-pro">
      <div class="card-image">
        <img src="assets/c2.png" alt="Bitraze Pro">
      </div>
    </div>

    <!-- Card 3: Bitraze Max -->
    <div class="investment-card card-max flex-shrink-0" routerLink="/bitraze-max">
      <div class="card-image">
        <img src="assets/c3.png" style="border-radius: 15px;" alt="Bitraze Max">
      </div>
    </div>

  </div>
</div>


<div class="container">
  <div class="global-fund-card flex-shrink-0 p-3 rounded-4 shadow-sm text-white text-center">
    <h5 class="fw-bold mb-2">Global Fund</h5>
    <div class="join-amount mb-3">
      <span class="amount">$0</span>
    </div>
    <button class="btn btn-light btn-sm fw-bold" routerLink="/btzbonus">Promotion Bonus</button>
  </div>
</div>


<!-- ASSETS / REFERRALS / G TEAM TOGGLE -->
<div class="container mt-3">
  <div class="d-flex justify-content-between toggle-btn-group shadow-sm">
    <button class="toggle-btn" [ngClass]="{'active': setassets}" (click)="showSection('setassets')">
      Assets
    </button>
    <button class="toggle-btn" [ngClass]="{'active': referrals}" (click)="showSection('referrals')">
      Referrals
    </button>
    <button class="toggle-btn" [ngClass]="{'active': glevel}" (click)="showSection('glevel')">
      G Team
    </button>
  </div>
</div>

<div class="mb-5">
  <!-- TRANSACTIONS VIEW -->
  <div class="container mt-3 mb-5" *ngIf="setassets">
  <!-- <div class="fw-bold mb-2 fs-5">Recent Transactions</div> -->
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div class="fw-bold">Recent Transactions</div>
        <a routerLink="/report" class="small text-decoration-none">View all</a>
      </div>
  <!-- Loading Spinner -->
  <div class="text-center my-4" *ngIf="loadingWallet">
    <img src="assets/favicon.png" alt="Loading..." style="width:50px; height:50px;">
    <p class="text-muted fw-semibold mt-2">Loading transactions...</p>
  </div>

  <!-- Wallet Data -->
  <div class="vstack gap-3" *ngIf="!loadingWallet && wdata?.length > 0">
    <div *ngFor="let wd of wdata" class="txn-card shadow-sm p-3 d-flex align-items-center rounded-3">
      <div class="txn-icon me-3"><i class="bi bi-person fs-4"></i></div>
      <div class="flex-grow-1 d-flex justify-content-between align-items-center">
        <div>
          <div class="fw-semibold">{{ wd.level }} {{wd.remark}}</div>
          <div class="text-muted small">{{ wd.cdate | date:'dd/MM/yyyy' }}</div>
        </div>
        <div class="text-end">
          <div [ngClass]="wd.amount >= 0 ? 'text-success fw-bold' : 'text-danger fw-bold'">
            {{ wd.amount | currency:'USD':'symbol':'1.0-2' }}
          </div>
          <span class="badge rounded-pill mt-1 px-3 py-1"
                [ngClass]="wd.amount >= 0 ? 'bg-success bg-opacity-10 text-success' : 'bg-danger bg-opacity-10 text-danger'">
            {{ wd.amount >= 0 ? 'Credit' : 'Debit' }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- No Data -->
  <div *ngIf="!loadingWallet && (!wdata || wdata.length === 0)" class="text-center mt-4">
    <p class="text-muted fw-semibold">No transactions available</p>
  </div>
</div>


  <!-- REFERRALS AND GTEAM COMPONENTS -->
  <div *ngIf="referrals"><app-referrals></app-referrals></div>
  <div *ngIf="glevel"><app-g-team></app-g-team></div>

</div>

  <app-footer></app-footer>

  
<!-- G-Team Income Modal -->
<div class="modal fade" id="gIncomeModal" tabindex="-1" aria-labelledby="gIncomeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content rounded-4 shadow-lg border-0">

      <!-- Header -->
      <div class="modal-header bg-gradient-blue text-white rounded-top-4">
        <h5 class="modal-title fw-bold" id="gIncomeModalLabel">G-Team Business</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <!-- Body -->
      <div class="modal-body p-3">
        <!-- Load component only when gbonus = true -->
        <ng-container *ngIf="gbonus">
          <app-gbonus-income></app-gbonus-income>
        </ng-container>
         <ng-container *ngIf="withdraw">
          <app-withdraw-fund></app-withdraw-fund>
        </ng-container>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0">
        <button class="btn btn-secondary w-100 rounded-pill" data-bs-dismiss="modal">
          Close
        </button>
      </div>

    </div>
  </div>
</div>


<!-- G-Team Income Modal -->
<div class="modal fade" id="withdrawfunds" tabindex="-1" aria-labelledby="gIncomeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content rounded-4 shadow-lg border-0">

      <!-- Header -->
      <div class="modal-header bg-gradient-blue text-white rounded-top-4">
        <h5 class="modal-title fw-bold" id="gIncomeModalLabel">Withdraw Fund</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <!-- Body -->
      <div class="modal-body p-3">
       
         <ng-container *ngIf="withdraw">
          <app-withdraw-fund></app-withdraw-fund>
        </ng-container>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0">
        <button class="btn btn-secondary w-100 rounded-pill" data-bs-dismiss="modal">
          Close
        </button>
      </div>

    </div>
  </div>
</div>